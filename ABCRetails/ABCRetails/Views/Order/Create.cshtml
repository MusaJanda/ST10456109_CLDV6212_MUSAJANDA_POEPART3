<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Your Order</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .order-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }

        .order-summary, .shipping-info {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 25px;
        }

        h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .cart-items {
            margin-bottom: 20px;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .item-details {
            display: flex;
            flex-direction: column;
        }

        .item-name {
            font-weight: 600;
        }

        .item-price {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .item-total {
            font-weight: 600;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
        }

        .total-row {
            font-weight: bold;
            font-size: 1.2em;
            border-top: 1px solid #eee;
            padding-top: 15px;
            margin-top: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        textarea {
            height: 100px;
            resize: vertical;
        }

        .place-order-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s;
        }

            .place-order-btn:hover {
                background-color: #2980b9;
            }

        .order-notes {
            margin-top: 20px;
        }

        .empty-cart-message {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
        }

        .cart-summary {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Place Your Order</h1>
            <p>Review your items and complete your purchase</p>
        </header>

        <div class="order-container">
            <div class="shipping-info">
                <div class="cart-summary">
                    <h3>Your Order</h3>
                    <div class="cart-items" id="cartItems">
                        <div class="empty-cart-message">Your cart is empty.</div>
                    </div>
                    <div class="summary-details">
                        <div class="summary-row">
                            <span>Subtotal:</span>
                            <span id="subtotal">R0.00</span>
                        </div>
                        <div class="summary-row">
                            <span>Shipping:</span>
                            <span id="shipping">R0.00</span>
                        </div>
                        <div class="summary-row">
                            <span>Tax:</span>
                            <span id="tax">R0.00</span>
                        </div>
                        <div class="summary-row total-row">
                            <span>Total:</span>
                            <span id="total">R0.00</span>
                        </div>
                    </div>
                </div>

                <h2>Shipping Information</h2>

                <form id="shippingForm">
                    <div class="form-group">
                        <label for="fullName">Full Name</label>
                        <input type="text" id="fullName" placeholder="Enter your full name" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" placeholder="Enter your email" required>
                    </div>

                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" placeholder="Enter your phone number" required>
                    </div>

                    <div class="form-group">
                        <label for="address">Shipping Address</label>
                        <textarea id="address" placeholder="Enter your complete shipping address" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="city">City</label>
                        <input type="text" id="city" placeholder="Enter your city" required>
                    </div>

                    <div class="form-group">
                        <label for="postalCode">Postal Code</label>
                        <input type="text" id="postalCode" placeholder="Enter your postal code" required>
                    </div>

                    <div class="form-group">
                        <label for="country">Country</label>
                        <select id="country" required>
                            <option value="">Select your country</option>
                            <option value="ZA">South Africa</option>
                            <option value="US">United States</option>
                            <option value="UK">United Kingdom</option>
                            <option value="CA">Canada</option>
                            <option value="AU">Australia</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="shippingMethod">Shipping Method</label>
                        <select id="shippingMethod" required>
                            <option value="">Select shipping method</option>
                            <option value="standard">Standard Delivery (R50.00)</option>
                            <option value="express">Express Delivery (R100.00)</option>
                            <option value="priority">Priority Delivery (R150.00)</option>
                        </select>
                    </div>

                    <div class="order-notes">
                        <label for="notes">Order Notes (Optional)</label>
                        <textarea id="notes" placeholder="Add any special instructions or notes about your order"></textarea>
                    </div>

                    <button type="submit" class="place-order-btn" id="placeOrderBtn">Place Order - R0.00</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Get cart data from URL parameters or localStorage
        function getCartData() {
            // Try to get from URL parameters first
            const urlParams = new URLSearchParams(window.location.search);
            const cartData = urlParams.get('cart');

            if (cartData) {
                try {
                    return JSON.parse(decodeURIComponent(cartData));
                } catch (e) {
                    console.error('Error parsing cart data from URL:', e);
                }
            }

            // Fallback to localStorage
            const storedCart = localStorage.getItem('customerCart');
            if (storedCart) {
                try {
                    return JSON.parse(storedCart);
                } catch (e) {
                    console.error('Error parsing cart data from localStorage:', e);
                }
            }

            return [];
        }

        // User's cart - populated from URL or localStorage
        let cartItems = getCartData();

        // Tax rate (10%)
        const taxRate = 0.1;

        // Shipping costs
        const shippingCosts = {
            standard: 50.00,
            express: 100.00,
            priority: 150.00
        };

        // DOM elements
        const cartItemsContainer = document.getElementById('cartItems');
        const subtotalElement = document.getElementById('subtotal');
        const shippingElement = document.getElementById('shipping');
        const taxElement = document.getElementById('tax');
        const totalElement = document.getElementById('total');
        const placeOrderBtn = document.getElementById('placeOrderBtn');
        const shippingMethodSelect = document.getElementById('shippingMethod');
        const shippingForm = document.getElementById('shippingForm');

        // Function to format currency
        function formatCurrency(amount) {
            return 'R' + amount.toFixed(2);
        }

        // Function to calculate and update order totals
        function updateOrderTotals() {
            // Calculate subtotal
            let subtotal = 0;
            cartItems.forEach(item => {
                subtotal += item.price * item.quantity;
            });

            // Get shipping cost
            const shippingMethod = shippingMethodSelect.value;
            const shippingCost = shippingCosts[shippingMethod] || 0;

            // Calculate tax
            const tax = subtotal * taxRate;

            // Calculate total
            const total = subtotal + shippingCost + tax;

            // Update DOM elements
            subtotalElement.textContent = formatCurrency(subtotal);
            shippingElement.textContent = formatCurrency(shippingCost);
            taxElement.textContent = formatCurrency(tax);
            totalElement.textContent = formatCurrency(total);
            placeOrderBtn.textContent = `Place Order - ${formatCurrency(total)}`;
        }

        // Function to render cart items
        function renderCartItems() {
            cartItemsContainer.innerHTML = '';

            if (cartItems.length === 0) {
                cartItemsContainer.innerHTML = '<div class="empty-cart-message">Your cart is empty.</div>';
                return;
            }

            cartItems.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'cart-item';

                const itemTotal = item.price * item.quantity;

                itemElement.innerHTML = `
                    <div class="item-details">
                        <div class="item-name">${item.name}</div>
                        <div class="item-price">${formatCurrency(item.price)} × ${item.quantity}</div>
                    </div>
                    <div class="item-total">${formatCurrency(itemTotal)}</div>
                `;

                cartItemsContainer.appendChild(itemElement);
            });
        }

        // Function to handle order placement
        function placeOrder(event) {
            event.preventDefault();

            // Check if cart is empty
            if (cartItems.length === 0) {
                alert('Your cart is empty. Please add products before placing an order.');
                return;
            }

            // Get form values
            const fullName = document.getElementById('fullName').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;
            const city = document.getElementById('city').value;
            const postalCode = document.getElementById('postalCode').value;
            const country = document.getElementById('country').value;
            const shippingMethod = document.getElementById('shippingMethod').value;
            const notes = document.getElementById('notes').value;

            // Validate required fields
            if (!fullName || !email || !phone || !address || !city || !postalCode || !country || !shippingMethod) {
                alert('Please fill in all required fields.');
                return;
            }

            // Prepare order data
            const orderData = {
                cartItems: cartItems,
                shippingInfo: {
                    fullName,
                    email,
                    phone,
                    address,
                    city,
                    postalCode,
                    country,
                    shippingMethod,
                    notes
                },
                totals: {
                    subtotal: parseFloat(subtotalElement.textContent.replace('R', '')),
                    shipping: parseFloat(shippingElement.textContent.replace('R', '')),
                    tax: parseFloat(taxElement.textContent.replace('R', '')),
                    total: parseFloat(totalElement.textContent.replace('R', ''))
                }
            };

            // In a real application, you would send this data to your server
            // For now, we'll just show a confirmation and clear the cart
            let orderDetails = `Order Summary:\n`;
            cartItems.forEach(item => {
                orderDetails += `- ${item.name} (${item.quantity} × ${formatCurrency(item.price)})\n`;
            });
            orderDetails += `\nTotal: ${totalElement.textContent}`;

            alert(`Thank you for your order, ${fullName}!\n\n${orderDetails}\n\nYour order has been placed successfully.`);

            // Clear cart and redirect (in a real app, you would redirect to order confirmation page)
            localStorage.removeItem('customerCart');
            cartItems = [];
            renderCartItems();
            updateOrderTotals();
            shippingForm.reset();
        }

        // Event listeners
        shippingMethodSelect.addEventListener('change', updateOrderTotals);
        shippingForm.addEventListener('submit', placeOrder);

        // Initialize the page
        renderCartItems();
        updateOrderTotals();
    </script>
</body>
</html>